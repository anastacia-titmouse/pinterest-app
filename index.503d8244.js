const e=()=>{const e=document.getElementById("desk_selector"),t=_();for(let n of Object.keys(t)){const o=t[n],d=document.createElement("option");d.setAttribute("value",n),d.innerHTML=o.title,o.active&&(e.value=o.id,d.setAttribute("selected","selected")),e.appendChild(d)}},t=()=>{document.getElementById("desk_selector").innerHTML="",e()};const n=e=>{document.getElementById("select_board_modal").classList.add("visible");document.getElementById("select_board_modal_pin_id").value=e,r(!1),document.getElementById("select_board_modal_selector").innerHTML="",function(){const e=document.getElementById("select_board_modal_selector"),t=_();for(let n of Object.keys(t)){if("main"===n)continue;const o=t[n],d=document.createElement("option");d.setAttribute("value",n),d.innerHTML=o.title,e.appendChild(d)}}()};function o(e){e.preventDefault();const t=document.getElementById("select_board_modal_pin_id").value,n=document.getElementById("select_board_modal_selector").value,o=localStorage.getItem(`desk-pins-${n}`);let c;c=o?new Set(JSON.parse(o)):new Set,c.add(t),localStorage.setItem(`desk-pins-${n}`,JSON.stringify(Array.from(c))),d()}function d(){document.getElementById("select_board_modal").classList.remove("visible"),r(!0)}const c=()=>{const e=document.getElementById("select_board_modal");window.onclick=function(t){t.target==e&&d()}};const a=e=>{document.getElementById("complaint_modal").style.display="flex";document.getElementById("complaint_modal_hidden_pin_id").value=e},l=()=>{document.getElementById("complaint_modal").style.display="none"},i=()=>{const e=document.getElementById("complaint_modal");window.onclick=function(t){t.target==e&&l()}},s=async e=>{e.preventDefault(),l()};function r(e){const t=document.querySelector("body");t.style.overflow=e?"inherit":"hidden"}function m(e,t){const n=document.getElementById(`pin_${t}`);n.parentElement.removeChild(n),function(e,t){const n=localStorage.getItem(`desk-pins-${e}`);let o;o=n?new Set(JSON.parse(n)):new Set;o.delete(t),console.log(o),localStorage.setItem(`desk-pins-${e}`,JSON.stringify(Array.from(o)))}(e,t)}function u(e){const t=_();for(let n of Object.keys(t))t[n].active=e===n,console.log(n),console.log(e===n);localStorage.setItem("desks",JSON.stringify(t))}function p(e,n,o){const d=_();return d[e]={id:e,title:n,active:o},localStorage.setItem("desks",JSON.stringify(d)),t(),d}function _(){const e=localStorage.getItem("desks");return e?JSON.parse(e):{}}async function g(){const e=document.getElementById("board_list");e.innerHTML="";let t=_();0===Object.keys(t).length&&(t=p("main","Homepage",!0));const o=function(){const e=_(),t=Object.keys(e).find((t=>e[t].active));if(t)return e[t]}();if(!o)throw new Error("Active desk not found");(await async function(e){let t=[];if("main"===e){const e=await fetch("https://63052f15697408f7edc32802.mockapi.io/api/v1/card",{method:"get"});t=await e.json()}else{const n=localStorage.getItem(`desk-pins-${e}`);if(n){pinIds=JSON.parse(n);const e=pinIds.map((e=>fetch(`https://63052f15697408f7edc32802.mockapi.io/api/v1/card/${e}`,{method:"get"}).then((e=>e.json()))));t=await Promise.all(e)}}const n=document.getElementById("search_top").value;return n?t.filter((e=>e.hashtag.startsWith(n))):t}(o.id)).map((t=>{const d=function(e,t){const o=document.createElement("div");o.classList.add("board-list__pin--wrap"),o.setAttribute("id",`pin_${e.id}`);const d=document.createElement("div");d.classList.add("board-list__pin"),o.appendChild(d);const c=document.createElement("img");c.classList.add("board-list__pin-img"),c.setAttribute("src",e.imageUrl),c.setAttribute("alt",e.imageUrl),d.appendChild(c);const l=document.createElement("div");l.classList.add("pin-actions-wrapper"),d.appendChild(l);const i=document.createElement("div");if(i.classList.add("pin-actions"),l.appendChild(i),"main"===t){const t=document.createElement("button");t.classList.add("pin-btn","add-pin"),t.textContent="Добавить",i.appendChild(t),t.onclick=()=>{n(e.id)}}else{const n=document.createElement("button");n.classList.add("pin-actions__delete-btn"),n.innerHTML="&times;",n.onclick=()=>{m(t,e.id)},i.appendChild(n)}const s=document.createElement("button");s.classList.add("pin-btn","complaint-pin"),s.textContent="Пожаловаться",s.onclick=()=>{a(e.id)},i.appendChild(s);const r=document.createElement("div");r.classList.add("board-list__description--wrapper"),o.appendChild(r);const u=document.createElement("div");u.classList.add("board-list__avatar-wrapper"),r.appendChild(u);const p=document.createElement("img");p.setAttribute("src",e.authorAvatar),p.classList.add("board-list__avatar"),u.appendChild(p);const _=document.createElement("p");return _.classList.add("board-list__description"),_.textContent=e.description,r.appendChild(_),o}(t,o.id);e.appendChild(d)}))}var y={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let f;const b=new Uint8Array(16);function E(){if(!f&&(f="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!f))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(b)}const v=[];for(let e=0;e<256;++e)v.push((e+256).toString(16).slice(1));function I(e,t=0){return(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase()}var h=function(e,t,n){if(y.randomUUID&&!t&&!e)return y.randomUUID();const o=(e=e||{}).random||(e.rng||E)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return I(o)};const k=()=>{const e=document.getElementById("create_board_modal");e&&(e.style.display="block"),toggleBodyScroll(!1)},L=()=>{document.getElementById("create_board_modal").style.display="none",w(""),S(),toggleBodyScroll(!0)},B=()=>{const e=document.getElementById("create-board-modal-close");window.onclick=function(t){t.target==e&&e()}},w=e=>{const t=document.querySelector("#crete_board_modal__form-error");e?(t.textContent=e,t.classList.add("visible")):t.classList.contains("visible")&&t.classList.remove("visible")},S=()=>{document.querySelector("#create_board_modal__desk-title-input").value="",w("")},C=e=>{e.preventDefault();const t=document.getElementById("crete_board_modal__form").querySelector("#create_board_modal__desk-title-input").value;if(!t)return void w("Missing desk title");const n=_();Object.keys(n).some((e=>t===n[e].title))?w("Desk with same title already exists"):(p(h(),t,!1),S(),L())};document.addEventListener("DOMContentLoaded",(()=>{e(),g().catch((e=>{console.log(e)})),window.onclick=()=>{i()},window.onclick=()=>{B()},window.onclick=()=>{c()},document.getElementById("complaint_modal_cancel").addEventListener("click",(()=>{l()})),document.getElementById("complaint_modal_form").addEventListener("submit",(e=>{s(e)})),document.getElementById("create_desk_btn").addEventListener("click",(()=>{k()})),document.getElementById("close_create_board_modal").addEventListener("click",(()=>{L()})),document.getElementById("crete_board_modal__form").addEventListener("submit",(e=>{C(e)})),document.getElementById("desk_selector").addEventListener("change",(e=>{u(e.target.value),g().catch((e=>{console.log(e)}))})),document.getElementById("close_select_board_modal").addEventListener("click",(()=>{d()})),document.getElementById("select_board_modal__form").addEventListener("submit",(e=>{o(e)})),document.getElementById("search_top").addEventListener("input",(()=>{g()})),document.getElementById("logo").addEventListener("click",(e=>{e.preventDefault(),u("main"),g(),document.getElementById("desk_selector").value="main"}))}));
//# sourceMappingURL=index.503d8244.js.map
